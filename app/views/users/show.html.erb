<div class="bg-white shadow rounded-lg p-6">
  <div class="flex justify-between items-center mb-6">
    <h1 class="text-2xl font-bold text-gray-900">User Details</h1>
    <div class="flex space-x-3">
      <%= link_to "← Back to Users", users_path, class: "text-blue-600 hover:text-blue-800" %>
      <%= link_to "Edit User", edit_user_path(@user), class: "bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md" %>
    </div>
  </div>

  <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
    <!-- User Information -->
    <div class="space-y-4">
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">Username</label>
        <div class="text-sm text-gray-900 bg-gray-50 px-3 py-2 rounded-md">
          <%= @user.username %>
        </div>
      </div>

      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">Full Name</label>
        <div class="text-sm text-gray-900 bg-gray-50 px-3 py-2 rounded-md">
          <%= @user.name %>
        </div>
      </div>

      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">Role</label>
        <div class="text-sm bg-gray-50 px-3 py-2 rounded-md">
          <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium 
            <%= case @user.role
                when 'admin' then 'bg-red-100 text-red-800'
                when 'manager' then 'bg-purple-100 text-purple-800'
                when 'supervisor' then 'bg-blue-100 text-blue-800'
                when 'sales_rep' then 'bg-green-100 text-green-800'
                when 'designer' then 'bg-yellow-100 text-yellow-800'
                when 'production_worker' then 'bg-orange-100 text-orange-800'
                when 'inventory_clerk' then 'bg-indigo-100 text-indigo-800'
                when 'quality_control' then 'bg-pink-100 text-pink-800'
                else 'bg-gray-100 text-gray-800'
                end %>">
            <%= @user.role&.humanize %>
          </span>
        </div>
      </div>

      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">Associated Employee</label>
        <div class="text-sm text-gray-900 bg-gray-50 px-3 py-2 rounded-md">
          <% if @user.employee %>
            <%= @user.employee.name %>
            <span class="text-gray-500 text-xs ml-2">(<%= @user.employee.department %>)</span>
          <% else %>
            <span class="text-gray-500">Not assigned to an employee</span>
          <% end %>
        </div>
      </div>
    </div>

    <!-- Account Information -->
    <div class="space-y-4">
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">Account Created</label>
        <div class="text-sm text-gray-900 bg-gray-50 px-3 py-2 rounded-md">
          <%= @user.created_at.strftime("%B %d, %Y at %I:%M %p") %>
        </div>
      </div>

      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">Last Updated</label>
        <div class="text-sm text-gray-900 bg-gray-50 px-3 py-2 rounded-md">
          <%= @user.updated_at.strftime("%B %d, %Y at %I:%M %p") %>
        </div>
      </div>

      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">Last Sign In</label>
        <div class="text-sm text-gray-900 bg-gray-50 px-3 py-2 rounded-md">
          <% if @user.remember_created_at %>
            <%= @user.remember_created_at.strftime("%B %d, %Y at %I:%M %p") %>
          <% else %>
            <span class="text-gray-500">Never signed in</span>
          <% end %>
        </div>
      </div>

      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">Account Status</label>
        <div class="text-sm bg-gray-50 px-3 py-2 rounded-md">
          <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800">
            Active
          </span>
        </div>
      </div>
    </div>
  </div>

  <!-- Role Permissions -->
  <div class="mt-8">
    <h3 class="text-lg font-medium text-gray-900 mb-4">Role Permissions</h3>
    <div class="bg-gray-50 rounded-lg p-4">
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
        <% permissions = case @user.role
           when 'admin'
             ['Full system access', 'User management', 'All modules', 'System configuration']
           when 'manager'
             ['Employee management', 'Financial data access', 'All business operations', 'Reports']
           when 'supervisor'
             ['View operations', 'Limited editing', 'Production oversight', 'Team management']
           when 'production_worker'
             ['Work order execution', 'Time tracking', 'Production updates']
           when 'inventory_clerk'
             ['Inventory management', 'Stock updates', 'Material tracking']
           when 'sales_rep'
             ['Sales order creation', 'Customer management', 'Order tracking']
           when 'designer'
             ['Design request management', 'Design uploads', 'Creative workflow']
           when 'quality_control'
             ['Quality inspections', 'Approval workflow', 'Quality reports']
           else
             ['Basic access']
           end %>
        
        <% permissions.each do |permission| %>
          <div class="flex items-center">
            <svg class="h-4 w-4 text-green-500 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
            </svg>
            <span class="text-sm text-gray-700"><%= permission %></span>
          </div>
        <% end %>
      </div>
    </div>
  </div>

  <!-- Actions -->
  <div class="mt-8 pt-6 border-t border-gray-200">
    <div class="flex justify-between">
      <div class="flex space-x-3">
        <%= link_to "Edit User", edit_user_path(@user), class: "bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md" %>
        <% unless @user == current_user %>
          <%= link_to "Delete User", user_path(@user), 
              data: { 
                turbo_method: :delete,
                turbo_confirm: "Are you sure you want to delete this user? This action cannot be undone." 
              }, 
              class: "bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-md" %>
        <% end %>
      </div>
      <%= link_to "Back to Users", users_path, class: "bg-gray-300 hover:bg-gray-400 text-gray-700 px-4 py-2 rounded-md" %>
    </div>
  </div>
</div>
