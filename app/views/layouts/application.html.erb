<!DOCTYPE html>
<html>
  <head>
    <title>Jewelry ERP</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <%= yield :head %>

    <%# Enable PWA manifest for installable apps (make sure to enable in config/routes.rb too!) %>
    <%#= tag.link rel: "manifest", href: pwa_manifest_path(format: :json) %>

    <link rel="icon" href="/icon.png" type="image/png">
    <link rel="icon" href="/icon.svg" type="image/svg+xml">
    <link rel="apple-touch-icon" href="/icon.png">

    <%# Includes all stylesheet files in app/assets/stylesheets %>
    <%= stylesheet_link_tag :app, "data-turbo-track": "reload" %>
    <%= javascript_importmap_tags %>
  </head>

  <body class="bg-gray-50 h-screen flex overflow-hidden">
    <!-- Mobile sidebar overlay -->
    <div class="md:hidden" id="mobile-sidebar-overlay" style="display: none;">
      <div class="fixed inset-0 flex z-40">
        <div class="fixed inset-0 bg-gray-600 bg-opacity-75" onclick="toggleMobileSidebar()"></div>
        <div class="relative flex-1 flex flex-col max-w-xs w-full bg-white">
          <div class="absolute top-0 right-0 -mr-12 pt-2">
            <button onclick="toggleMobileSidebar()" class="ml-1 flex items-center justify-center h-10 w-10 rounded-full focus:outline-none focus:ring-2 focus:ring-inset focus:ring-white">
              <span class="sr-only">Close sidebar</span>
              <svg class="h-6 w-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
              </svg>
            </button>
          </div>
          
          <!-- Mobile sidebar content (same as desktop) -->
          <div class="flex flex-col h-0 flex-1 bg-white border-r border-gray-200">
            <!-- Logo -->
            <div class="flex-1 flex flex-col pt-5 pb-4 overflow-y-auto">
              <div class="flex items-center flex-shrink-0 px-4 mb-8">
                <%= link_to root_path, class: "flex items-center space-x-2" do %>
                  <div class="w-8 h-8 bg-indigo-600 rounded-lg flex items-center justify-center">
                    <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                      <path d="M3 4a1 1 0 011-1h12a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V4zM3 10a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H4a1 1 0 01-1-1v-6zM14 9a1 1 0 00-1 1v6a1 1 0 001 1h2a1 1 0 001-1v-6a1 1 0 00-1-1h-2z"></path>
                    </svg>
                  </div>
                  <span class="text-xl font-semibold text-gray-900">Jewelry ERP</span>
                <% end %>
              </div>
              
              <!-- Mobile Navigation (same as desktop) -->
              <nav class="mt-5 flex-1 px-2 space-y-1">
                <!-- Dashboard -->
                <%= link_to dashboard_path, 
                    class: "group flex items-center px-2 py-2 text-sm font-medium rounded-md #{'bg-indigo-100 text-indigo-700' if current_page?(dashboard_path)} #{'text-gray-600 hover:bg-gray-50 hover:text-gray-900' unless current_page?(dashboard_path)}",
                    onclick: "toggleMobileSidebar()" do %>
                  <svg class="mr-3 h-5 w-5 #{'text-indigo-500' if current_page?(dashboard_path)} #{'text-gray-400 group-hover:text-gray-500' unless current_page?(dashboard_path)}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2H5a2 2 0 00-2-2z"></path>
                  </svg>
                  Dashboard
                <% end %>

                <% if can_see_link?(:supervisor_access) %>
                  <!-- Employees -->
                  <%= link_to employees_path, 
                      class: "group flex items-center px-2 py-2 text-sm font-medium rounded-md #{'bg-indigo-100 text-indigo-700' if current_page?(employees_path)} #{'text-gray-600 hover:bg-gray-50 hover:text-gray-900' unless current_page?(employees_path)}",
                      onclick: "toggleMobileSidebar()" do %>
                    <svg class="mr-3 h-5 w-5 #{'text-indigo-500' if current_page?(employees_path)} #{'text-gray-400 group-hover:text-gray-500' unless current_page?(employees_path)}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"></path>
                    </svg>
                    Employees
                  <% end %>

                  <!-- Add similar onclick="toggleMobileSidebar()" to all other nav items -->
                  <%= link_to customers_path, 
                      class: "group flex items-center px-2 py-2 text-sm font-medium rounded-md #{'bg-indigo-100 text-indigo-700' if current_page?(customers_path)} #{'text-gray-600 hover:bg-gray-50 hover:text-gray-900' unless current_page?(customers_path)}",
                      onclick: "toggleMobileSidebar()" do %>
                    <svg class="mr-3 h-5 w-5 #{'text-indigo-500' if current_page?(customers_path)} #{'text-gray-400 group-hover:text-gray-500' unless current_page?(customers_path)}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path>
                    </svg>
                    Customers
                  <% end %>

                  <%= link_to products_path, 
                      class: "group flex items-center px-2 py-2 text-sm font-medium rounded-md #{'bg-indigo-100 text-indigo-700' if current_page?(products_path)} #{'text-gray-600 hover:bg-gray-50 hover:text-gray-900' unless current_page?(products_path)}",
                      onclick: "toggleMobileSidebar()" do %>
                    <svg class="mr-3 h-5 w-5 #{'text-indigo-500' if current_page?(products_path)} #{'text-gray-400 group-hover:text-gray-500' unless current_page?(products_path)}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"></path>
                    </svg>
                    Products
                  <% end %>

                  <%= link_to sales_orders_path, 
                      class: "group flex items-center px-2 py-2 text-sm font-medium rounded-md #{'bg-indigo-100 text-indigo-700' if current_page?(sales_orders_path)} #{'text-gray-600 hover:bg-gray-50 hover:text-gray-900' unless current_page?(sales_orders_path)}",
                      onclick: "toggleMobileSidebar()" do %>
                    <svg class="mr-3 h-5 w-5 #{'text-indigo-500' if current_page?(sales_orders_path)} #{'text-gray-400 group-hover:text-gray-500' unless current_page?(sales_orders_path)}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                    </svg>
                    Orders
                  <% end %>

                  <%= link_to production_orders_path, 
                      class: "group flex items-center px-2 py-2 text-sm font-medium rounded-md #{'bg-indigo-100 text-indigo-700' if current_page?(production_orders_path)} #{'text-gray-600 hover:bg-gray-50 hover:text-gray-900' unless current_page?(production_orders_path)}",
                      onclick: "toggleMobileSidebar()" do %>
                    <svg class="mr-3 h-5 w-5 #{'text-indigo-500' if current_page?(production_orders_path)} #{'text-gray-400 group-hover:text-gray-500' unless current_page?(production_orders_path)}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"></path>
                    </svg>
                    Production
                  <% end %>

                  <%= link_to inventory_path, 
                      class: "group flex items-center px-2 py-2 text-sm font-medium rounded-md #{'bg-indigo-100 text-indigo-700' if current_page?(inventory_path)} #{'text-gray-600 hover:bg-gray-50 hover:text-gray-900' unless current_page?(inventory_path)}",
                      onclick: "toggleMobileSidebar()" do %>
                    <svg class="mr-3 h-5 w-5 #{'text-indigo-500' if current_page?(inventory_path)} #{'text-gray-400 group-hover:text-gray-500' unless current_page?(inventory_path)}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"></path>
                    </svg>
                    Inventory
                  <% end %>

                  <%= link_to materials_path, 
                      class: "group flex items-center px-2 py-2 text-sm font-medium rounded-md #{'bg-indigo-100 text-indigo-700' if current_page?(materials_path)} #{'text-gray-600 hover:bg-gray-50 hover:text-gray-900' unless current_page?(materials_path)}",
                      onclick: "toggleMobileSidebar()" do %>
                    <svg class="mr-3 h-5 w-5 #{'text-indigo-500' if current_page?(materials_path)} #{'text-gray-400 group-hover:text-gray-500' unless current_page?(materials_path)}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"></path>
                    </svg>
                    Materials
                  <% end %>

                  <%= link_to design_requests_path, 
                      class: "group flex items-center px-2 py-2 text-sm font-medium rounded-md #{'bg-indigo-100 text-indigo-700' if current_page?(design_requests_path)} #{'text-gray-600 hover:bg-gray-50 hover:text-gray-900' unless current_page?(design_requests_path)}",
                      onclick: "toggleMobileSidebar()" do %>
                    <svg class="mr-3 h-5 w-5 #{'text-indigo-500' if current_page?(design_requests_path)} #{'text-gray-400 group-hover:text-gray-500' unless current_page?(design_requests_path)}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"></path>
                    </svg>
                    Design Requests
                  <% end %>
                <% end %>

                <% if can_see_link?(:admin_access) %>
                  <%= link_to users_path, 
                      class: "group flex items-center px-2 py-2 text-sm font-medium rounded-md #{'bg-indigo-100 text-indigo-700' if current_page?(users_path)} #{'text-gray-600 hover:bg-gray-50 hover:text-gray-900' unless current_page?(users_path)}",
                      onclick: "toggleMobileSidebar()" do %>
                    <svg class="mr-3 h-5 w-5 #{'text-indigo-500' if current_page?(users_path)} #{'text-gray-400 group-hover:text-gray-500' unless current_page?(users_path)}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                    </svg>
                    Users
                  <% end %>
                <% end %>
              </nav>
            </div>
            
            <!-- Mobile User Profile -->
            <div class="flex-shrink-0 flex bg-white p-4 border-t border-gray-200">
              <% if user_signed_in? %>
                <div class="flex-shrink-0 w-full group block">
                  <div class="flex items-center">
                    <div class="inline-block h-9 w-9 rounded-full overflow-hidden bg-gray-100">
                      <svg class="h-full w-full text-gray-300" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M24 20.993V24H0v-2.996A14.977 14.977 0 0112.004 15c4.904 0 9.26 2.354 11.996 5.993zM16.002 8.999a4 4 0 11-8 0 4 4 0 018 0z" />
                      </svg>
                    </div>
                    <div class="ml-3 flex-1">
                      <p class="text-sm font-medium text-gray-700 group-hover:text-gray-900">
                        <%= current_user.name %>
                      </p>
                      <div class="flex items-center justify-between">
                        <p class="text-xs font-medium text-gray-500 group-hover:text-gray-700">
                          <%= current_user.role&.humanize %>
                        </p>
                        <%= button_to destroy_user_session_path, method: :delete, 
                            class: "text-xs text-gray-400 hover:text-red-600 bg-transparent border-0 p-0", 
                            title: "Sign Out",
                            data: { confirm: "Are you sure you want to sign out?" } do %>
                          <svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path>
                          </svg>
                        <% end %>
                      </div>
                    </div>
                  </div>
                </div>
              <% end %>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Desktop Sidebar -->
    <div class="hidden md:flex md:flex-shrink-0">
      <div class="flex flex-col w-64">
        <div class="flex flex-col h-0 flex-1 bg-white border-r border-gray-200">
          <!-- Logo -->
          <div class="flex-1 flex flex-col pt-5 pb-4 overflow-y-auto">
            <div class="flex items-center flex-shrink-0 px-4 mb-8">
              <%= link_to root_path, class: "flex items-center space-x-2" do %>
                <div class="w-8 h-8 bg-indigo-600 rounded-lg flex items-center justify-center">
                  <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                    <path d="M3 4a1 1 0 011-1h12a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V4zM3 10a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H4a1 1 0 01-1-1v-6zM14 9a1 1 0 00-1 1v6a1 1 0 001 1h2a1 1 0 001-1v-6a1 1 0 00-1-1h-2z"></path>
                  </svg>
                </div>
                <span class="text-xl font-semibold text-gray-900">Jewelry ERP</span>
              <% end %>
            </div>
            
            <!-- Navigation -->
            <nav class="mt-5 flex-1 px-2 space-y-1">
              <!-- Dashboard -->
              <%= link_to dashboard_path, 
                  class: "group flex items-center px-2 py-2 text-sm font-medium rounded-md #{'bg-indigo-100 text-indigo-700' if current_page?(dashboard_path)} #{'text-gray-600 hover:bg-gray-50 hover:text-gray-900' unless current_page?(dashboard_path)}" do %>
                <svg class="mr-3 h-5 w-5 #{'text-indigo-500' if current_page?(dashboard_path)} #{'text-gray-400 group-hover:text-gray-500' unless current_page?(dashboard_path)}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2H5a2 2 0 00-2-2z"></path>
                </svg>
                Dashboard
              <% end %>

              <% if can_see_link?(:supervisor_access) %>
                <!-- Employees -->
                <%= link_to employees_path, 
                    class: "group flex items-center px-2 py-2 text-sm font-medium rounded-md #{'bg-indigo-100 text-indigo-700' if current_page?(employees_path)} #{'text-gray-600 hover:bg-gray-50 hover:text-gray-900' unless current_page?(employees_path)}" do %>
                  <svg class="mr-3 h-5 w-5 #{'text-indigo-500' if current_page?(employees_path)} #{'text-gray-400 group-hover:text-gray-500' unless current_page?(employees_path)}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"></path>
                  </svg>
                  Employees
                <% end %>

                <!-- Customers -->
                <%= link_to customers_path, 
                    class: "group flex items-center px-2 py-2 text-sm font-medium rounded-md #{'bg-indigo-100 text-indigo-700' if current_page?(customers_path)} #{'text-gray-600 hover:bg-gray-50 hover:text-gray-900' unless current_page?(customers_path)}" do %>
                  <svg class="mr-3 h-5 w-5 #{'text-indigo-500' if current_page?(customers_path)} #{'text-gray-400 group-hover:text-gray-500' unless current_page?(customers_path)}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path>
                  </svg>
                  Customers
                <% end %>

                <!-- Products -->
                <%= link_to products_path, 
                    class: "group flex items-center px-2 py-2 text-sm font-medium rounded-md #{'bg-indigo-100 text-indigo-700' if current_page?(products_path)} #{'text-gray-600 hover:bg-gray-50 hover:text-gray-900' unless current_page?(products_path)}" do %>
                  <svg class="mr-3 h-5 w-5 #{'text-indigo-500' if current_page?(products_path)} #{'text-gray-400 group-hover:text-gray-500' unless current_page?(products_path)}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"></path>
                  </svg>
                  Products
                <% end %>

                <!-- Sales Orders -->
                <%= link_to sales_orders_path, 
                    class: "group flex items-center px-2 py-2 text-sm font-medium rounded-md #{'bg-indigo-100 text-indigo-700' if current_page?(sales_orders_path)} #{'text-gray-600 hover:bg-gray-50 hover:text-gray-900' unless current_page?(sales_orders_path)}" do %>
                  <svg class="mr-3 h-5 w-5 #{'text-indigo-500' if current_page?(sales_orders_path)} #{'text-gray-400 group-hover:text-gray-500' unless current_page?(sales_orders_path)}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                  </svg>
                  Orders
                <% end %>

                <!-- Production Orders -->
                <%= link_to production_orders_path, 
                    class: "group flex items-center px-2 py-2 text-sm font-medium rounded-md #{'bg-indigo-100 text-indigo-700' if current_page?(production_orders_path)} #{'text-gray-600 hover:bg-gray-50 hover:text-gray-900' unless current_page?(production_orders_path)}" do %>
                  <svg class="mr-3 h-5 w-5 #{'text-indigo-500' if current_page?(production_orders_path)} #{'text-gray-400 group-hover:text-gray-500' unless current_page?(production_orders_path)}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"></path>
                  </svg>
                  Production
                <% end %>

                <!-- Inventory -->
                <%= link_to inventory_path, 
                    class: "group flex items-center px-2 py-2 text-sm font-medium rounded-md #{'bg-indigo-100 text-indigo-700' if current_page?(inventory_path)} #{'text-gray-600 hover:bg-gray-50 hover:text-gray-900' unless current_page?(inventory_path)}" do %>
                  <svg class="mr-3 h-5 w-5 #{'text-indigo-500' if current_page?(inventory_path)} #{'text-gray-400 group-hover:text-gray-500' unless current_page?(inventory_path)}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"></path>
                  </svg>
                  Inventory
                <% end %>

                <!-- Materials -->
                <%= link_to materials_path, 
                    class: "group flex items-center px-2 py-2 text-sm font-medium rounded-md #{'bg-indigo-100 text-indigo-700' if current_page?(materials_path)} #{'text-gray-600 hover:bg-gray-50 hover:text-gray-900' unless current_page?(materials_path)}" do %>
                  <svg class="mr-3 h-5 w-5 #{'text-indigo-500' if current_page?(materials_path)} #{'text-gray-400 group-hover:text-gray-500' unless current_page?(materials_path)}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"></path>
                  </svg>
                  Materials
                <% end %>

                <!-- Design Requests -->
                <%= link_to design_requests_path, 
                    class: "group flex items-center px-2 py-2 text-sm font-medium rounded-md #{'bg-indigo-100 text-indigo-700' if current_page?(design_requests_path)} #{'text-gray-600 hover:bg-gray-50 hover:text-gray-900' unless current_page?(design_requests_path)}" do %>
                  <svg class="mr-3 h-5 w-5 #{'text-indigo-500' if current_page?(design_requests_path)} #{'text-gray-400 group-hover:text-gray-500' unless current_page?(design_requests_path)}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"></path>
                  </svg>
                  Design Requests
                <% end %>
              <% end %>

              <% if can_see_link?(:admin_access) %>
                <!-- Users (Admin) -->
                <%= link_to users_path, 
                    class: "group flex items-center px-2 py-2 text-sm font-medium rounded-md #{'bg-indigo-100 text-indigo-700' if current_page?(users_path)} #{'text-gray-600 hover:bg-gray-50 hover:text-gray-900' unless current_page?(users_path)}" do %>
                  <svg class="mr-3 h-5 w-5 #{'text-indigo-500' if current_page?(users_path)} #{'text-gray-400 group-hover:text-gray-500' unless current_page?(users_path)}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                  </svg>
                  Users
                <% end %>
              <% end %>
            </nav>
          </div>
          
          <!-- User Profile -->
          <div class="flex-shrink-0 flex bg-white p-4 border-t border-gray-200">
            <% if user_signed_in? %>
              <div class="flex-shrink-0 w-full group block">
                <div class="flex items-center">
                  <div class="inline-block h-9 w-9 rounded-full overflow-hidden bg-gray-100">
                    <svg class="h-full w-full text-gray-300" fill="currentColor" viewBox="0 0 24 24">
                      <path d="M24 20.993V24H0v-2.996A14.977 14.977 0 0112.004 15c4.904 0 9.26 2.354 11.996 5.993zM16.002 8.999a4 4 0 11-8 0 4 4 0 018 0z" />
                    </svg>
                  </div>
                  <div class="ml-3 flex-1">
                    <p class="text-sm font-medium text-gray-700 group-hover:text-gray-900">
                      <%= current_user.name %>
                    </p>
                    <div class="flex items-center justify-between">
                      <p class="text-xs font-medium text-gray-500 group-hover:text-gray-700">
                        <%= current_user.role&.humanize %>
                      </p>
                      <%= button_to destroy_user_session_path, method: :delete, 
                          class: "text-xs text-gray-400 hover:text-red-600 bg-transparent border-0 p-0", 
                          title: "Sign Out",
                          data: { confirm: "Are you sure you want to sign out?" } do %>
                        <svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path>
                        </svg>
                      <% end %>
                    </div>
                  </div>
                </div>
              </div>
            <% end %>
          </div>
        </div>
      </div>
    </div>

    <!-- Main content -->
    <div class="flex flex-col w-0 flex-1 overflow-hidden">
      <!-- Top navigation for mobile -->
      <div class="md:hidden pl-1 pt-1 sm:pl-3 sm:pt-3">
        <button onclick="toggleMobileSidebar()" class="-ml-0.5 -mt-0.5 h-12 w-12 inline-flex items-center justify-center rounded-md text-gray-500 hover:text-gray-900 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-indigo-500">
          <span class="sr-only">Open sidebar</span>
          <svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
          </svg>
        </button>
      </div>
      
      <!-- Main content area -->
      <main class="flex-1 relative overflow-y-auto focus:outline-none">
        <div class="py-6">
          <div class="max-w-7xl mx-auto px-4 sm:px-6 md:px-8">
            <!-- Flash messages -->
            <%= render 'shared/flash_messages' if notice || alert %>
            
            <!-- Page content -->
            <%= yield %>
          </div>
        </div>
      </main>
    </div>

    <script>
      function toggleMobileSidebar() {
        const overlay = document.getElementById('mobile-sidebar-overlay');
        if (overlay.style.display === 'none' || overlay.style.display === '') {
          overlay.style.display = 'block';
          // Prevent body scrolling when sidebar is open
          document.body.style.overflow = 'hidden';
        } else {
          overlay.style.display = 'none';
          // Restore body scrolling
          document.body.style.overflow = 'auto';
        }
      }

      // Close mobile sidebar when clicking outside or pressing escape
      document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape') {
          const overlay = document.getElementById('mobile-sidebar-overlay');
          if (overlay.style.display === 'block') {
            toggleMobileSidebar();
          }
        }
      });

      // Close sidebar on window resize to desktop size
      window.addEventListener('resize', function() {
        if (window.innerWidth >= 768) { // md breakpoint
          const overlay = document.getElementById('mobile-sidebar-overlay');
          overlay.style.display = 'none';
          document.body.style.overflow = 'auto';
        }
      });
    </script>
  </body>
</html>
